---
layout: post
title: 图解HTTP
category: [网络,图书阅读]
tags: [网络,图书]
---

### 首先这本书看了一遍之后,发现他就是个面向绝对纯新手的书籍,入门看的,他针对的一些知识点知识略微科普下,让你简单了解什么是http,http是无状态的,而至于他的顺序性,可靠性,还有tcp的延迟启动,慢启动都没有说,甚至3次握手都是简单说下,所以不推荐买,这些东西自己网络上面看看就好了.没有帮助,除非你是萌新入门,否则还是直接看HTTP权威指南吧.那个介绍的比较详细,毕竟1200页的书籍,介绍也非常的细致

下面简单整理下吧


HTTP1.0和HTTP1.1之间支持的方法区别

![](http://pic.woowen.com/http1andhttp1.0.png)

#### 持久连接

HTTP1.0时期,每次创建一个http通信都需要创建一次TCP连接
HTTP1.1时期,实现了持久连接,只要客户端和服务端任意一方没有提成明确的断开则保持TCP状态,1.1中所有的连接默认都是持久连接,减少了每次TCP断开再重新创建的额外资源消耗,加快了页面加载的速度


#### 流水线(管线化)

持久连接虽然减少了TCP创建的时间,但是每次http通信还是需要等待上一次的通信结果返回,才能继续通信,而流水线就是可以直接通信,不用等待上一次的结果返回,http1.1中,针对每个域名的并发http连接请求是于限制的.而在HTTP2.0中因为有了多路复用,因此没有了相关的限制

流水线过程

![](http://pic.woowen.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-04-05%20%E4%B8%8A%E5%8D%8812.19.22.png)

#### HTTP报文

报文是http通信中的单位

![](http://pic.woowen.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-04-05%20%E4%B8%8A%E5%8D%8812.21.32.png)

#### 编码

一般通过对报文body的压缩编码,使得报文主体部分size变小,从而加快传输,通常的压缩有gzip,compress 而HTTP2.0支持对head(头部)的压缩

#### 分块传输

![](http://pic.woowen.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-04-05%20%E4%B8%8A%E5%8D%8812.24.31.png)

每次报文传输之前会先将报文主体分成多个块,最后一块用0(CR+LF)来标记

#### 指定范围

5001~10 000 字节

``` Range: bytes=5001-10000 ```

5001字节之后

``` Range: bytes=5001- ```

从3000 字节和 5000 7000 字节的多重范围

Range: bytes=-3000, 5000-7000

#### SPDY

使用SPDY后,http协议额外获得了以下功能

* 1.多路复用,通过单一的TCP连接,可以无限制的处理多个HTTP请求,所有的请求处理都在一条TCP连接上完成
* 2.请求优先级,可以给多个请求分配优先级,譬如,js和css的优先级一般都是高于图片的.这有用户在网络很慢的情况下,最先出来的肯定是页面的一个整体结构,就不会因为加载图片而导致用户觉得页面非常慢
* 3.压缩HTTP head
* 4.推送功能,支持服务端主动向客户端推送数据

#### Cache-Control

关于HTTP的缓存其中有几个字段需要说明一下

Cache-Control 有几个值,分别是public,private,no-cache,no-store
其中no-cache是不直接使用缓存,但是依然会进行缓存,只是缓存的有效期为0.也就是客户端使用缓存之前需要去服务端验证该缓存是否被修改过.如果没有被修改过,那么依然可用

no-store是禁止缓存

与之相关的还有2个,分别是last-modified和Etag,这两个都是在Http1.1版本中添加进来的
last-modified,表示服务端资源是否被修改过,用于记录最后修改时间,但是它的记录单位是秒,也就是如果服务端一秒中修改很多次.那么客户端是无感知的
Etag用于弥补last-modified的缺点,相当于记录资源的标识码,如果资源被修改那么Etag也会跟着改变

例如,当Cache-Control是no-cache的时候,缓存在浏览器本地,但是有效时间为0,那么浏览器访问该缓存的时候,需要发送last-modified和Etag去客户端校验,该资源有没有被修改过,如果有修改,那么服务端返回200并且重新发送资源,如果没有,那么返回304,直接使用缓存

除了Cache-Control,还有Expires可以用来标识缓存有效时间,但是这个头部字段是在Http1.0中加入的.而且它是根据服务端时间来设置的.如果客户端时间和服务端时间不一致,那么这个字段也就失去了意义.因此在Http1.1中,如果同时存在Expires和Cache-Control,前者会被后者覆盖,以后者为












