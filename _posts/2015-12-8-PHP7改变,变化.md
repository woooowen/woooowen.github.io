---
layout: post
title: PHP7改变,变化
category: [PHP]
tags: [PHP]
---



PHP5.6 的 ...

... 是一个关键字

<?php

function sum(...$numbers) {
    $acc = 0;
    foreach ($numbers as $n) {
        $acc += $n;
    }
    return $acc;
}

echo sum(1, 2, 3, 4);

?>


<?php
function add($a, $b) {
    return $a + $b;
}

echo add(...[1, 2])."\n";

$a = [1, 2];
echo add(...$a);
?>




不能给NULL值,会报错
<?php
function total_intervals($unit, DateInterval ...$intervals) {
    $time = 0;
    foreach ($intervals as $interval) {
        $time += $interval->$unit;
    }
    return $time;
}

$a = new DateInterval('P1D');
$b = new DateInterval('P2D');
echo total_intervals('d', $a, $b).' days';

// This will fail, since null isn't a DateInterval object.
echo total_intervals('d', null);
?>





Expression	PHP 5 interpretation	PHP 7 interpretation
$$foo['bar']['baz']	${$foo['bar']['baz']}	($$foo)['bar']['baz']
$foo->$bar['baz']	$foo->{$bar['baz']}	($foo->$bar)['baz']
$foo->$bar['baz']()	$foo->{$bar['baz']}()	($foo->$bar)['baz']()
Foo::$bar['baz']()	Foo::{$bar['baz']}()	(Foo::$bar)['baz']()



<?php
list($a[], $a[], $a[]) = [1, 2, 3];
var_dump($a);
?>




<?php
list() = $a;
list(,,) = $a;
list($x, list(), $y) = $a;
?>

list的参数不能再为空了.
list不能再解析字符串,可以使用 str_split() 


针对有歧义的语法做出调整

<?php
function f() {
    // Valid in PHP 5 only.
    global $$foo->bar;

    // Valid in PHP 5 and 7.
    global ${$foo->bar};
}
?>

foreach 发送细微变化

在PHP7之前，当数组通过 foreach 迭代时，数组指针会移动。现在开始，不再如此，见下面代码

<?php
$array = [0, 1, 2];
foreach ($array as &$val) {
    var_dump(current($array));
}
?>


foreach通过引用遍历时，有更好的迭代特性 ¶

当使用引用遍历数组时，现在 foreach 在迭代中能更好的跟踪变化。例如，在迭代中添加一个迭代值到数组中，参考下面的代码：

<?php
$array = [0];
foreach ($array as &$val) {
    var_dump($val);
    $array[1] = 1;
}
?>


debug_zval_dump() now prints "int" instead of "long", and "float" instead of "double"
dirname() now optionally takes a second parameter, depth, to get the name of the directory depth levels up from the current directory.
getrusage() is now supported on Windows.
mktime() and gmmktime() functions no longer accept is_dst parameter.
preg_replace() function no longer supports "\e" (PREG_REPLACE_EVAL). preg_replace_callback() should be used instead.
setlocale() function no longer accepts category passed as string. LC_* constants must be used instead.
exec(), system() and passthru() functions have NULL byte protection now.
add a note add a note










