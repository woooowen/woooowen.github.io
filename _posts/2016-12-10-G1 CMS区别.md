---
layout: post
title: JAVA8 G1 CMS 区别
category: [JAVA]
tags: [JAVA]
---

#### 1.堆(heap)空间分配不同

* CMS 将堆逻辑上分成Eden,Survivor(S0,S1),Old,并且他们是固定大小JVM启动的时候就已经设定不能改变,并且是连续的内存块
* G1 将堆分成多个大小相同的Region(区域),默认2048个,在1Mb到32Mb之间大小,逻辑上分成Eden,Survivor,Old,巨型,空闲,他们不是固定大小,会根据每次GC的信息做出调整

#### 2.并发标记阶段三色标记算法处理结果不同

* CMS 在三色标记算法阶段,如果将白色对象重新分配给黑色对象时,在分配期间采用增量更新方式(写屏障中发现白色对象引用被分配给黑色对象时,分配过程中将白色重新设置为灰色,即插入的时候就记录修改)
* G1 在三色标记算法阶段,如果将白色对象重新分配给黑色对象时,采用SATB,并发标记阶段,所有被改变的对象入队,在写屏障中统一处理为灰色


#### 3.压缩策略不同

* CMS中不启用压缩会产生很多内存碎片,当产生很多内存碎片的时候,找不到空间来分配剩余的对象,或者设定参数,使它合并相邻的的空闲内存,当合并超过一定次数后触发Full GC,进行压缩
* G1中每次回收过程中,将多个Region拷贝到空闲Region的时候都会进行压缩

#### 4.可预测停顿

* 相比CMS,G1可以设定每次GC的时间,从而让GC在规定时间内回收效益最大的内存

#### 5.GC策略不同

* CMS中,GC的策略分为,Young GC,Old GC,Full GC
* G1中,GC的策略分为,Young GC,Mixed GC,Full GC