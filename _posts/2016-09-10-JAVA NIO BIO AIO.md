---
layout: post
title: JAVA NIO BIO AIO
category: [JAVA]
tags: [JAVA,网络]
---

#### JAVA NIO,BIO,AIO区别

* NIO 非阻塞I/O
* BIO 阻塞I/O
* AIO 异步I/O

##### 同步VS异步

* 同步: 进行I/O操作的时候某一个过程是阻塞的,也就是当前线程只能等待结果返回,不能用于其他处理
* 异步: 进行I/O操作的时候,整个过程只参与请求系统调用,之后就可以处理其他事情,不用等待结果返回,I/O处理完成之后通过可以通知请求线程处理,或者调用回调函数处理结果

##### 阻塞VS非阻塞

* 阻塞: 当前线程发起请求之后就一直阻塞,不能进行其他操作,只能等待结果返回
* 非阻塞: 当前线程发起请求之后就可以进行其他操作,不用等待结果返回

##### I/O模型

* 阻塞I/O
* 非阻塞I/O
* I/O复用
* 信号驱动I/O
* 异步I/O

每个I/O操作可以分为几个阶段

* 1. 系统调用
* 2. 内核数据准备
* 3. 内核数据拷贝到用户空间
* 4. 用户空间返回结果给用户应用进行处理

##### 阻塞I/O

![](http://pic.woowen.com/bio.png)

进行系统调用之后,内核会等待数据准备就绪,当数据准备就绪之后,将数据从内核拷贝进入用户内存,然后返回结果,这个过程中,当前线程一直处于等待操作结果的过程中,结果返回之前,线程都只能等待,此时一个线程对应一个I/O操作,在此过程中,内核数据准备和数据拷贝都是阻塞状态

##### 非阻塞I/O

![](http://pic.woowen.com/nio.png)

进行系统调用之后,会立刻返回一个ERROR,表示内核数据还没有准备完毕,此时当前线程可以进行其他操作,不用等待,但是需要调用者主动去询问内核是否准备完毕,这个过程只有调用者不断去询问,但是因为是非阻塞的,因此一个线程可以对应多个I/O操作,在此过程中,只有数据拷贝是阻塞状态

另外非阻塞I/O需要调用者不断询问数据是否准备好,因此会浪费资源在无用的不断遍历循环上

##### I/O复用

![](http://pic.woowen.com/ioselector.png)

I/O复用会调用select,poll,epoll几个函数,这几个函数会阻塞线程,调用select之后线程会被阻塞,但是它可以监听多个I/O操作,其中任意一个数据准备完毕就返回,因此一个select可以对应多个I/O连接,底层通过不断循环遍历来判断是否就绪

##### 异步I/O

![](http://pic.woowen.com/aio.png)

异步I/O在系统调用之后当前线程就可以去执行其他操作,内核在数据准备就绪,复制到用户空间完成之后会通知调用方或者执行调用方的回调函数

##### 几种I/O模型的区别

![](http://pic.woowen.com/5iodiff.png)
